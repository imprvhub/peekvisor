---
import { languages, defaultLang } from "../../i18n/ui";
import Icon from "./icons/Icon.astro";

const { pathname } = Astro.url;

const pathWithoutLang = pathname.startsWith(`/${defaultLang}`)
  ? pathname.replace(`/${defaultLang}`, "")
  : pathname.replace(/^\/[a-z]{2}/, "");
---

<div class="hs-dropdown relative inline-flex">
  <button
    id="hs-dropdown-default"
    type="button"
    aria-label="Change language"
    class="hs-dropdown-toggle hover:text-brand inline-flex items-center gap-x-1 rounded-lg px-1.5 py-0.5 text-sm font-medium text-neutral-600 ring-zinc-500 outline-hidden transition duration-300 hover:bg-neutral-200 dark:border-neutral-700 dark:text-neutral-400 dark:ring-zinc-200 dark:hover:bg-neutral-700 dark:hover:text-[#7C86FF] dark:focus:outline-hidden"
  >
    <Icon name="earth" />
    <svg
      class="hs-dropdown-open:rotate-180 size-4"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2"
      stroke-linecap="round"
      stroke-linejoin="round"><path d="m6 9 6 6 6-6"></path></svg
    >
  </button>

  <div
    class="hs-dropdown-menu hs-dropdown-open:opacity-100 min-w-24 z-10 hidden bg-white shadow-md rounded-lg p-2 opacity-0 transition-opacity duration-300 dark:bg-[#171717] dark:border dark:border-neutral-700"
    aria-labelledby="hs-dropdown-hover-event"
  >
    {
      Object.entries(languages).map(([lang, label]) => (
        <a
          class="flex items-center gap-x-3.5 py-2 px-3 rounded-lg text-sm text-neutral-800 hover:bg-neutral-100 focus:ring-2 focus:ring-blue-500 dark:text-neutral-400 dark:hover:bg-neutral-700 dark:hover:text-neutral-300"
          href={`/${lang}${pathWithoutLang || "/"}`}
        >
          {label}
        </a>
      ))
    }
  </div>
</div>
